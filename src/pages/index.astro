---
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import Carousel from "../components/Carousel.astro";
// Cart functionality has been removed
import BrandsGrid from "../components/BrandsGrid.astro";
import ProductCard from "../components/Catalog/ProductCard.astro";
import { supabase } from "../lib/supabase";
import type { Product } from "../types/catalog";

// Definir un tipo para las promociones
interface Promotion {
  id: number;
  title: string;
  description: string;
  image_path: string;
  whatsapp_message: string;
}

// Las promociones ahora vienen exclusivamente desde Supabase

const services = [
  {
    icon: "tools",
    title: "Mantenimiento",
    description:
      "Servicio técnico especializado para tu moto con los mejores mecánicos certificados",
    video: "reparacion.mp4",
    color: "#e30613",
  },
  {
    icon: "paint-brush",
    title: "Personalización",
    description:
      "Dale un toque único a tu moto con nuestros servicios de personalización premium",
    video: "personalizacion.mp4",
    color: "#ff9500",
  },
  {
    icon: "tachometer-alt",
    title: "Tunning",
    description:
      "Mejora el rendimiento de tu moto con nuestras soluciones de tunning profesional",
    video: "tunning.mp4",
    color: "#2563eb",
  },
  {
    icon: "truck",
    title: "Envíos",
    description:
      "Entrega a domicilio en toda la región con seguimiento en tiempo real",
    video: "envio.mp4",
    color: "#10b981",
  },
];

// Obtener promociones desde Supabase
let promotions: Promotion[] = [];

try {
  // Obtener las promociones desde la tabla 'promotions'
  const { data: promotionsData, error: promotionsError } = await supabase
    .from('promotions')
    .select('*')
    .order('created_at', { ascending: false });

  if (promotionsError) throw promotionsError;
  
  // Procesar las promociones para asegurar que las URLs de las imágenes sean correctas usando el método optimizado
  promotions = (promotionsData || []).map(promo => {
    // Obtener la URL de la imagen desde Supabase siguiendo el mismo patrón que en productos
    const imagePath = promo.image_path?.startsWith('http')
      ? promo.image_path
      : promo.image_path
        ? supabase.storage.from('promos').getPublicUrl(promo.image_path).data.publicUrl
        : '/images/promo1.png';
    
    return {
      ...promo,
      image_path: imagePath
    };
  });
  
  console.log(`Obtenidas ${promotions.length} promociones de Supabase`);
  // Imprimir las URLs de las imágenes para depuración
  promotions.forEach((promo, index) => {
    console.log(`Promoción ${index + 1} - Imagen: ${promo.image_path}`);
  });
} catch (error) {
  console.error('Error al obtener promociones de Supabase:', error);
}

// Obtener productos destacados desde Supabase
let featuredProducts: Product[] = [];

try {
  // Obtener productos destacados (featured = true) con sus categorías
  const { data: productsData, error: productsError } = await supabase
    .from('products')
    .select(`
      *,
      categories:category_id (name)
    `)
    .eq('featured', true)
    .order('created_at', { ascending: false })
    .limit(4);

  if (productsError) throw productsError;

  // Transformar los datos al formato esperado por el componente
  featuredProducts = (productsData || []).map(product => {
    // Obtener la URL de la imagen desde Supabase si es necesario
const imageUrl = product.image?.startsWith('http') 
  ? product.image 
  : supabase.storage.from('productos').getPublicUrl(product.image).data.publicUrl;

return {
  id: product.id,
  name: product.name,
  description: product.description || product.name,
  price: product.price,
  image: imageUrl,
  featured: product.featured,
  details: product.details || product.name,
  discount: product.discount,
  category_id: product.category_id,
  categories: product.categories
};

  });

  console.log(`Obtenidos ${featuredProducts.length} productos destacados de Supabase`);
} catch (error) {
  console.error('Error al obtener productos destacados de Supabase:', error);
}

const brands = [
  { name: "Honda", logo: "/images/brands/Honda_Logo.svg.png" },
  { name: "Yamaha", logo: "/images/brands/Yamaha-Logo.png" },
  { name: "Kawasaki", logo: "/images/brands/Kawasaki-logo.png" },
  { name: "Suzuki", logo: "/images/brands/Suzuki_Motor_Corporation_logo.png" },
  { name: "BMW", logo: "/images/brands/BMW_logo.png" },
  { name: "Ducati", logo: "/images/brands/dukati_logo.png" },
];
---

<Layout title="Inicio">
  <Header slot="header" />

  <!-- Hero Banner con Carrusel de Servicios -->
  <section class="hero-banner" id="hero-banner">
    <!-- Promo Box (fuera del carrusel) -->
    <div class="promo-box">
      <div class="promo-bg">
        {promotions.map((promo, index) => (
          <div 
            class="promo-bg-item" 
            style={`background-image: url('${promo.image_path}'); ${index === 0 ? 'opacity: 1;' : 'opacity: 0;'}`}
          ></div>
        ))}
        
        {/* Solo se mostrarán las promociones de Supabase */}
      </div>
      <div class="promo-content">
        {/* Promociones dinámicas desde Supabase */}
        {promotions.map((promo, index) => (
          <div class={`promo-item ${index === 0 ? 'active' : ''}`} data-promo={index}>
            <div class="promo-content-inner">
              <h3 class="promo-title">{promo.title}</h3>
              <p class="promo-details">{promo.description}</p>
              <a 
                href={`https://wa.me/51999999999?text=${encodeURIComponent(promo.whatsapp_message)}`} 
                target="_blank" 
                class="promo-button"
              >
                Solicitar
              </a>
            </div>
          </div>
        ))}
        
        {/* Solo se mostrarán las promociones almacenadas en Supabase */}
      </div>
    </div>
    
    <div class="hero-slides-container">
      <!-- Slide 1: Repuestos -->
      <div class="hero-slide active" data-index="0">
        <div class="hero-overlay" style="background: linear-gradient(to right, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.5))"></div>
        <div class="hero-background" style="background-image: url('/images/maintent_hero.png')"></div>
        <div class="hero-content">
          <div class="hero-text">
            <span class="hero-subtitle">PREMIUM MOTORCYCLE EXPERIENCE</span>
            <h1 class="hero-title">ZONA BIKER 15</h1>
            <h2 class="hero-service-title">{services[0].title}</h2>
            <p class="hero-description">{services[0].description}</p>
            <div class="hero-buttons">
              <a href="/services" class="btn btn-primary">VER DETALLES</a>
              <a href="/catalog" class="btn btn-secondary">VER CATÁLOGO</a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Slide 2: Personalización -->
      <div class="hero-slide" data-index="1">
        <div class="hero-overlay" style="background: linear-gradient(to right, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.5))"></div>
        <div class="hero-background" style="background-image: url('/images/personalisation_hero.png')"></div>
        <div class="hero-content">
          <div class="hero-text">
            <span class="hero-subtitle">PREMIUM MOTORCYCLE EXPERIENCE</span>
            <h1 class="hero-title">ZONA BIKER 15</h1>
            <h2 class="hero-service-title">{services[1].title}</h2>
            <p class="hero-description">{services[1].description}</p>
            <div class="hero-buttons">
              <a href="/services" class="btn btn-primary">VER DETALLES</a>
              <a href="/catalog" class="btn btn-secondary">VER CATÁLOGO</a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Slide 3: Tunning -->
      <div class="hero-slide" data-index="2">
        <div class="hero-overlay" style="background: linear-gradient(to right, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.5))"></div>
        <div class="hero-background" style="background-image: url('/images/tunning_hero.png')"></div>
        <div class="hero-content">
          <div class="hero-text">
            <span class="hero-subtitle">PREMIUM MOTORCYCLE EXPERIENCE</span>
            <h1 class="hero-title">ZONA BIKER 15</h1>
            <h2 class="hero-service-title">{services[2].title}</h2>
            <p class="hero-description">{services[2].description}</p>
            <div class="hero-buttons">
              <a href="/services" class="btn btn-primary">VER DETALLES</a>
              <a href="/catalog" class="btn btn-secondary">VER CATÁLOGO</a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Slide 4: Envíos -->
      <div class="hero-slide" data-index="3">
        <div class="hero-overlay" style="background: linear-gradient(to right, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.5))"></div>
        <div class="hero-background" style="background-image: url('/images/envio_provincias.png')"></div>
        <div class="hero-content">
          <div class="hero-text">
            <span class="hero-subtitle">PREMIUM MOTORCYCLE EXPERIENCE</span>
            <h1 class="hero-title">ZONA BIKER 15</h1>
            <h2 class="hero-service-title">{services[3].title}</h2>
            <p class="hero-description">{services[3].description}</p>
            <div class="hero-buttons">
              <a href="/services" class="btn btn-primary">VER DETALLES</a>
              <a href="/catalog" class="btn btn-secondary">VER CATÁLOGO</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Indicadores y controles -->
    <div class="hero-controls">
      <div class="hero-indicators">
        <span class="hero-indicator active" data-index="0"></span>
        <span class="hero-indicator" data-index="1"></span>
        <span class="hero-indicator" data-index="2"></span>
        <span class="hero-indicator" data-index="3"></span>
      </div>
      <div class="hero-arrows">
        <button class="hero-arrow prev">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button class="hero-arrow next">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </section>


  <!-- Featured Products Section -->
  <section class="section products-section">
    <div class="container">
      <div class="section-header">
        <span class="section-subtitle">Lo mejor de nuestro catálogo</span>
        <h2 class="section-title">Productos Destacados</h2>
        <p class="section-description">
          Descubre nuestra selección de productos premium para motociclistas
          exigentes
        </p>
      </div>
      <div class="products-grid">
        {
          featuredProducts.map((product) => (
            <ProductCard 
              product={product}
              categoryName={product.categories?.name || 'Sin categoría'}
            />
          ))
        }
      </div>

      <div class="products-cta">
        <a href="/catalog" class="btn btn-outline btn-lg">
          Ver catálogo completo <i class="fas fa-arrow-right"></i>
        </a>
      </div>
    </div>
  </section>

  <!-- Brands Section -->
  <section class="brands-section" id="brands">
    <div class="container">
      <div class="section-header">
        <span class="section-subtitle">Trabajamos con las mejores</span>
        <h2 class="section-title">Nuestras Marcas</h2>
        <p class="section-description">
          Representamos las marcas más reconocidas en el mundo del motociclismo,
          ofreciendo productos de la más alta calidad.
        </p>
      </div>

      <BrandsGrid brands={brands} />
    </div>
  </section>

  <Footer slot="footer" />
</Layout>

<style>
  /* Hero Banner - Lamborghini Style */
  .hero-banner {
    position: relative;
    height: 60vh;
    min-height: 500px;
    overflow: visible;
    z-index: 1;
    background-color: #000;
  }
  
  .hero-slides-container {
    position: relative;
    width: 100%;
    height: 100%;
  }
  
  .hero-slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    visibility: hidden;
    transition: opacity 1s ease, visibility 1s ease;
  }
  
  .hero-slide.active {
    opacity: 1;
    visibility: visible;
  }
  
  .hero-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: contain;
    background-position: right center;
    background-repeat: no-repeat;
    background-color: #000;
    z-index: -1;
    transition: opacity 1s ease-in-out;
  }

  .hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to right, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.5));
    z-index: 5;
  }

  .hero-carousel-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }

  .hero-content {
    position: relative;
    z-index: 10;
    padding: 0 5%;
    color: var(--text-light);
    width: 100%;
    max-width: 1200px;
    padding: 0 2rem;
    margin: 0 auto;
    height: 100%;
    display: flex;
    align-items: center;
  }
  
  .hero-text {
    flex: 1;
    color: white;
    max-width: 650px;
    z-index: 10;
  }

  .hero-subtitle {
    font-size: 1rem;
    font-weight: 600;
    letter-spacing: 2px;
    color: var(--red-500);
    margin-bottom: 1rem;
    text-transform: uppercase;
    animation: fadeInUp 1s ease-out;
    color: #ffffff;
  }

  .hero-title {
    font-size: 3.5rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    line-height: 1.1;
    text-transform: uppercase;
    animation: fadeInDown 1s ease-out;
    letter-spacing: 1px;
    color: #ffffff;
  }
  
  .hero-service-title {
    font-size: 4rem;
    font-weight: 900;
    margin-bottom: 1.5rem;
    color: #ffffff;
    text-transform: uppercase;
    text-shadow: 2px 2px 0px rgba(255, 0, 0, 0.7), 0 0 2px rgba(255, 0, 0, 0.2);
    position: relative;
    display: inline-block;
    animation: fadeInUp 1s ease-out 0.3s forwards;
    opacity: 0;
    letter-spacing: 0px;
    line-height: 1;
    width: 100%;
    word-break: keep-all;
    overflow: visible;
  }
  
  .hero-service-title::after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -5px;
    height: 3px;
    width: 0;
    background: linear-gradient(90deg, transparent, #ff0000, #ff3333, #ff0000, transparent);
    animation: line-animation 2s ease-in-out 1s forwards;
  }
  
  .hero-description {
    font-size: 1.2rem;
    line-height: 1.6;
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 2rem;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.4);
    animation: fadeInUp 1s ease-out 0.5s forwards;
    opacity: 0;
    max-width: 90%;
    font-weight: 400;
  }

  .hero-controls {
    position: absolute;
    bottom: 30px;
    left: 0;
    width: 100%;
    z-index: 20;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  
  .hero-indicators {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-bottom: 20px;
  }
  
  .hero-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.3);
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .hero-indicator.active {
    background-color: var(--red-500);
    transform: scale(1.2);
  }
  
  .hero-indicator:hover {
    background-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.2);
  }
  
  .hero-arrows {
    display: flex;
    gap: 20px;
  }
  
  .hero-arrow {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .hero-arrow:hover {
    background-color: var(--red-500);
    transform: scale(1.1);
  }
  
  @keyframes line-animation {
    0% { width: 0; }
    100% { width: 100%; }
  }

  .hero-buttons {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    animation: fadeInUp 1s ease-out 0.7s forwards;
    opacity: 0;
  }
  
  /* Promo Box - Versión Móvil (por defecto) */
  .promo-box {
    display: none; /* Ocultar por defecto en móviles */
  }
  
  /* Versión Móvil */
  @media (max-width: 1023px) {
    .promo-box {
      display: flex !important;
      position: absolute;
      right: 5%;
      top: 85%;
      transform: translateY(20%);
      max-width: 90%;
      width: 280px;
      min-height: 100px;
      height: 35%;
      padding: 15px 20px;
      border-radius: 10px;
      border: 2px solid #fff;
      text-align: center;
      box-shadow: 0 5px 25px rgba(0,0,0,0.5);
      overflow: hidden;
      z-index: 1000;
      align-items: center;
      justify-content: center;
      background-color: rgba(0, 0, 0, 0.7);
    }
    
    .promo-button {
      padding: 12px 20px;
      font-size: 1rem;
      width: 100%;
    }
    
    .promo-bg-item {
      opacity: 0.6 !important;
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      height: 100% !important;
      background-size: cover !important;
      background-position: center !important;
      animation: changeImage 24s infinite ease-in-out !important;
    }
  }
  
  /* Versión Desktop */
  @media (min-width: 1024px) {
    .promo-box {
      display: block;
      position: absolute;
      right: 8%;
      bottom: -35%;
      background-color: rgba(0, 0, 0, 0.85);
      color: white;
      padding: 25px 30px;
      border-radius: 10px;
      max-width: 280px;
      border: 2px solid #fff;
      text-align: center;
      box-shadow: 0 5px 25px rgba(0,0,0,0.5);
      animation: fadeIn 1s ease-out;
      z-index: 10;
      overflow: hidden;
    }
    
    .promo-box {
      position: absolute;
      right: 8%;
      bottom: -35%;
      max-width: 280px;
      width: 100%;
      height: 60%; /* Aumentada la altura */
      padding: 25px 30px;
      border-radius: 10px;
      border: 2px solid #fff;
      text-align: center;
      box-shadow: 0 5px 25px rgba(0,0,0,0.5);
      overflow: hidden;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .promo-bg {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: -1;
    }
    
    .promo-bg-item {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
    }
    
    .promo-content {
      position: relative;
      z-index: 1;
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 100%;
    }
    
    /* Estilos para los ítems de promociones */
    .promo-item {
      display: none;
      opacity: 0;
      transition: opacity 0.5s ease;
      text-align: center;
      width: 100%;
      height: 100%;
    }
    
    .promo-item.active {
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 1;
      animation: fadeIn 0.8s ease-in-out;
    }
    
    .promo-content-inner {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      padding: 15px;
    }
    
    /* Espaciado interno de los items de promoción */
    .promo-title {
      margin-bottom: 8px;
      color: white;
      text-shadow: 0 1px 3px rgba(0,0,0,0.3);
      font-size: 1.3rem;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    
    .promo-details {
      margin-bottom: 15px;
      color: rgba(255, 255, 255, 0.9);
      font-size: 1rem;
    }
  
  
  .promo-title {
    font-size: 1.4rem;
    font-weight: 700;
    margin-bottom: 8px;
    letter-spacing: 0.3px;
  }
  
  .promo-deal {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 10px;
  }
  
  .promo-percentage {
    font-size: 2rem;
    font-weight: 900;
    color: white;
    position: relative;
  }
  
  .promo-upto {
    position: absolute;
    top: -15px;
    right: -25px;
    font-size: 0.8rem;
    font-weight: normal;
    background-color: #000;
    padding: 2px 5px;
    border-radius: 3px;
  }
  
  .promo-details {
    font-size: 0.9rem;
    margin-bottom: 15px;
    opacity: 0.9;
  }
  
  .promo-button {
    display: inline-block;
    background-color: #10b981; /* Verde vibrante */
    color: white;
    padding: 12px 25px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 700;
    font-size: 1.1rem;
    text-transform: uppercase;
    transition: all 0.3s ease;
    letter-spacing: 0.8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    border: 2px solid rgba(255, 255, 255, 0.2);
  }
  
  .promo-button:hover {
    background-color: #059669; /* Verde más oscuro en hover */
    transform: translateY(-4px) scale(1.08);
    box-shadow: 0 8px 20px rgba(0,0,0,0.25);
    border-color: rgba(255, 255, 255, 0.4);
  }
  
  .promo-button:active {
    transform: translateY(1px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
  }

  /* Section Headers */
  .section-header {
    text-align: center;
    margin-bottom: 3rem;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .section-subtitle {
    display: inline-block;
    font-size: 1rem;
    font-weight: 600;
    color: var(--biker-red);
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 0.5rem;
    position: relative;
  }

  .section-subtitle::after {
    content: "";
    display: block;
    width: 50px;
    height: 2px;
    background: var(--biker-red);
    margin: 0.5rem auto 0;
  }

  .section-description {
    color: var(--gray-600);
    font-size: 1.1rem;
    line-height: 1.6;
    margin-top: 1rem;
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
  }

  /* Services Section */
  .services-section {
    background-color: var(--gray-50);
    position: relative;
    overflow: hidden;
    padding: 5rem 0;
  }

  .services-section::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23e5e7eb' fill-opacity='0.3'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    opacity: 0.5;
    z-index: 0;
  }

  .services-grid {
    gap: 2rem;
  }

  .service-card {
    text-align: center;
    padding: 2.5rem 2rem;
    background-color: white;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    transition: all 0.4s ease;
    position: relative;
    overflow: hidden;
    border-top: 4px solid var(--service-color, var(--biker-red));
    z-index: 1;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .service-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
  }

  .service-card::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      135deg,
      var(--service-color, var(--biker-red)) 0%,
      transparent 80%
    );
    opacity: 0;
    transition: opacity 0.4s ease;
    z-index: -1;
  }

  .service-card:hover::before {
    opacity: 0.05;
  }

  .service-icon {
    font-size: 3rem;
    color: var(--service-color, var(--biker-red));
    margin-bottom: 1.5rem;
    transition: all 0.3s ease;
  }

  .service-card:hover .service-icon {
    transform: scale(1.1);
  }

  .service-card h3 {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
    color: var(--gray-900);
  }

  .service-card p {
    color: var(--gray-600);
    margin-bottom: 1.5rem;
    flex-grow: 1;
  }

  .service-link {
    display: inline-flex;
    align-items: center;
    color: var(--service-color, var(--biker-red));
    font-weight: 600;
    transition: all 0.3s ease;
    gap: 0.5rem;
  }

  .service-link i {
    transition: transform 0.3s ease;
  }

  .service-link:hover {
    color: var(--biker-red-dark);
  }

  .service-link:hover i {
    transform: translateX(5px);
  }

  .service-video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.5s ease;
    z-index: -2;
  }

  .service-card:hover .service-video {
    opacity: 0.15;
  }

  /* Products Section */
  .products-section {
    padding: 6rem 0;
    background-color: #fff;
  }

  .products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 1.5rem;
  }

  @media (max-width: 768px) {
    .products-grid {
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 1rem;
    }
  }

  @media (max-width: 480px) {
    .products-grid {
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 0.75rem;
    }
  }

  .product-card {
    background-color: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    transition: all 0.4s ease;
    position: relative;
    height: 100%;
    display: flex;
    flex-direction: column;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .product-badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: #00bcd4; /* Color celeste */
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 700;
    z-index: 10;
    box-shadow: 0 4px 10px rgba(0, 188, 212, 0.3);
  }

  .product-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
  }

  .product-image {
    height: 220px;
    overflow: hidden;
    position: relative;
  }

  .product-actions {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    background: rgba(0, 0, 0, 0.5);
    opacity: 0;
    transition: all 0.3s ease;
  }

  .product-card:hover .product-actions {
    opacity: 1;
  }

  .product-action-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--biker-red);
    transition: all 0.3s ease;
    transform: translateY(20px);
  }

  .product-card:hover .product-action-btn {
    transform: translateY(0);
  }

  .product-action-btn:hover {
    background: var(--biker-red);
    color: white;
  }

  .product-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .product-card:hover .product-image img {
    transform: scale(1.1);
  }

  .product-info {
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    flex-grow: 1;
  }

  .product-category {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    background-color: var(--gray-200);
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--gray-700);
    margin-bottom: 0.75rem;
  }

  .product-info h3 {
    font-size: 1.25rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: var(--gray-900);
  }

  .product-rating {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    margin-bottom: 0.75rem;
    color: #ffc107;
  }

  .product-rating span {
    color: var(--gray-600);
    font-size: 0.875rem;
    margin-left: 0.5rem;
  }

  .product-price {
    color: var(--biker-red);
    font-weight: 700;
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
    margin-top: auto;
  }

  .add-to-cart {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
  }

  .add-to-cart i {
    transition: transform 0.3s ease;
  }

  .add-to-cart:hover i {
    transform: translateX(3px);
  }

  .products-cta {
    text-align: center;
    margin-top: 3rem;
  }

  /* Brands Section */
  .brands-section {
    background-color: var(--gray-50);
    position: relative;
    overflow: hidden;
    padding: 5rem 0;
  }

  .brands-section::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23e5e7eb' fill-opacity='0.3'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    opacity: 0.5;
    z-index: 0;
  }

  .brands-section .container {
    position: relative;
    z-index: 1;
  }

  /* Testimonials Section */
  .testimonials-section {
    background-color: white;
    padding: 5rem 0;
  }

  .testimonials-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 2rem;
    margin-top: 2rem;
  }

  .testimonial-card {
    background-color: var(--gray-50);
    border-radius: 12px;
    padding: 2rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    position: relative;
  }

  .testimonial-card::before {
    content: '"';
    position: absolute;
    top: 1rem;
    right: 1.5rem;
    font-size: 5rem;
    font-family: serif;
    color: var(--biker-red);
    opacity: 0.1;
    line-height: 1;
  }

  .testimonial-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
  }

  .testimonial-rating {
    color: #ffc107;
    margin-bottom: 1rem;
    display: flex;
    gap: 0.25rem;
  }

  .testimonial-text {
    font-size: 1.1rem;
    line-height: 1.6;
    color: var(--gray-700);
    margin-bottom: 1.5rem;
    font-style: italic;
  }

  .testimonial-author {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .testimonial-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--biker-red);
  }

  .testimonial-info h4 {
    font-size: 1rem;
    font-weight: 700;
    margin: 0;
    color: var(--gray-900);
  }

  .testimonial-info span {
    font-size: 0.875rem;
    color: var(--gray-600);
  }

  /* Animations */
  @keyframes fadeInDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  @keyframes changeImage {
    0%, 13% {
      opacity: 0.7;
    }
    16.6%, 95% {
      opacity: 0;
    }
    100% {
      opacity: 0.7;
    }
  }

  /* Responsive Design */
  @media (max-width: 1200px) {
    .hero-title {
      font-size: 3.5rem;
    }
  }

  @media (max-width: 992px) {
    .services-grid,
    .products-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .hero-title {
      font-size: 3rem;
    }

    .hero-subtitle {
      font-size: 1.25rem;
    }
  }

  /* Media queries para texto responsive en el hero */
  @media (max-width: 1200px) {
    .hero-service-title {
      font-size: 3.8rem;
    }
    
    .hero-title {
      font-size: 3rem;
    }
  }
  
  @media (max-width: 992px) {
    .hero-service-title {
      font-size: 3.2rem;
    }
    
    .hero-title {
      font-size: 2.8rem;
    }
    
    .hero-description {
      font-size: 1.1rem;
    }
  }
  
  @media (max-width: 768px) {
    .products-section {
      margin-top: 80px; /* Añadido margen superior para móviles */
    }
    
    .testimonials-grid {
      grid-template-columns: 1fr;
    }

    .hero-title {
      font-size: 2.5rem;
    }
    
    .hero-service-title {
      font-size: 2.8rem;
      margin-bottom: 1rem;
    }
    
    .hero-subtitle {
      font-size: 0.9rem;
      margin-bottom: 0.75rem;
    }
    
    .hero-description {
      font-size: 1rem;
      margin-bottom: 1.5rem;
      max-width: 100%;
    }

    .hero-banner {
      height: auto;
      min-height: 60vh;
      width: 100%;
      margin: 0;
      padding: 0 0 60px 0;
      position: relative;
      overflow: visible;
    }
    
    .hero-background {
      width: 100%;
      min-height: 60vh;
      background-size: cover !important;
      background-position: center !important;
    }
    
    .hero-slides-container,
    .hero-slide {
      width: 100%;
      margin: 0;
      padding: 0;
    }
    
    /* Versión Móvil */
    .promo-box {
      display: block;
      position: absolute;
      left: 50%;
      bottom: -90px;
      transform: translateX(-50%);
      width: 85%;
      max-width: 300px;
      margin: 0 auto;
      z-index: 100;
      background-color: #d00;
      color: white;
      padding: 15px 20px;
      border-radius: 5px;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      animation: fadeIn 1s ease-out;
    }

    .service-card,
    .product-card {
      padding: 1.5rem;
    }

    .service-icon {
      font-size: 2.5rem;
    }

    .product-image {
      height: 180px;
    }
  }

@media (max-width: 576px) {
    .hero-title {
      font-size: 2rem;
      margin-bottom: 1rem;
    }
    
    .hero-service-title {
      font-size: 2.2rem;
      margin-bottom: 0.75rem;
    }
    
    .hero-subtitle {
      font-size: 0.8rem;
      letter-spacing: 1px;
    }
    
    .hero-description {
      font-size: 0.9rem;
      line-height: 1.4;
    }
    
    .hero-text {
      max-width: 100%;
    }
    .products-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
    }

    .product-card {
      padding: 0.5rem;
    }

    .product-info {
      padding: 0.75rem;
    }

    .product-price {
      font-size: 1.25rem;
    }
}


  /* Lamborghini Style Buttons */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 1rem 2.5rem;
    font-family: var(--font-heading);
    font-size: 0.9rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    text-decoration: none;
    border: 2px solid transparent;
    border-radius: 0;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    min-width: 200px;
  }

  .btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
  }

  .btn:hover::before {
    left: 100%;
  }

  .btn-primary {
    background: var(--lambo-gold);
    color: var(--lambo-black);
    border-color: var(--lambo-gold);
  }

  .btn-primary:hover {
    background: transparent;
    color: var(--lambo-gold);
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(212, 175, 55, 0.3);
  }

  .btn-secondary {
    background: transparent;
    color: var(--text-light);
    border-color: var(--text-light);
  }

  .btn-secondary:hover {
    background: var(--text-light);
    color: var(--lambo-black);
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(255, 255, 255, 0.2);
  }

  /* Animations */
  @keyframes fadeInDown {
    from {
      opacity: 0;
      transform: translateY(-30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .hero-banner {
      height: 80vh;
      min-height: 600px;
    }

    .hero-content {
      padding: 0 1rem;
      text-align: center;
    }

    .hero-text {
      max-width: 100%;
    }

    .hero-buttons {
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .btn {
      width: 100%;
      max-width: 280px;
    }
  }
</style>

<script>
  document.addEventListener("astro:page-load", () => {
    initPage();
    initHeroCarousel();
  });

  function initHeroCarousel() {
    const slides = document.querySelectorAll('.hero-slide');
    const indicators = document.querySelectorAll('.hero-indicator');
    const prevBtn = document.querySelector('.hero-arrow.prev');
    const nextBtn = document.querySelector('.hero-arrow.next');
    let currentIndex = 0;
    let intervalId;

    // Inicializar el primer slide como activo
    slides[0].classList.add('active');

    // Función para mostrar un slide específico
    function showSlide(index) {
      // Ocultar el slide actual
      slides[currentIndex].classList.remove('active');
      indicators[currentIndex].classList.remove('active');

      // Actualizar el índice y mostrar el nuevo slide
      currentIndex = index;
      slides[currentIndex].classList.add('active');
      indicators[currentIndex].classList.add('active');
    }

    // Función para ir al siguiente slide
    function nextSlide() {
      const newIndex = (currentIndex + 1) % slides.length;
      showSlide(newIndex);
    }

    // Función para ir al slide anterior
    function prevSlide() {
      const newIndex = (currentIndex - 1 + slides.length) % slides.length;
      showSlide(newIndex);
    }

    // Iniciar carrusel automático
    intervalId = setInterval(nextSlide, 3000);

    // Agregar eventos a los indicadores
    indicators.forEach((indicator, index) => {
      indicator.addEventListener('click', () => {
        clearInterval(intervalId);
        showSlide(index);
        intervalId = setInterval(nextSlide, 3000);
      });
    });

    // Agregar eventos a los botones de navegación
    if (prevBtn) {
      prevBtn.addEventListener('click', () => {
        clearInterval(intervalId);
        prevSlide();
        intervalId = setInterval(nextSlide, 3000);
      });
    }

    if (nextBtn) {
      nextBtn.addEventListener('click', () => {
        clearInterval(intervalId);
        nextSlide();
        intervalId = setInterval(nextSlide, 3000);
      });
    }

    // Pausar carrusel al hover
    const heroContainer = document.querySelector('.hero-banner');
    if (heroContainer) {
      heroContainer.addEventListener('mouseenter', () => {
        clearInterval(intervalId);
      });

      heroContainer.addEventListener('mouseleave', () => {
        intervalId = setInterval(nextSlide, 3000);
      });
    }
  }

  // Also initialize on DOMContentLoaded to ensure it works on first load
  document.addEventListener("DOMContentLoaded", () => {
    initPage();
    initHeroCarousel();
  });

  function initPage() {
    // Inicializar rotación de promociones
    initPromoRotation();
    
    // Initialize service videos
    document.querySelectorAll(".service-card").forEach((card) => {
      const video = card.querySelector("video");
      if (!video) return;

      card.addEventListener("mouseenter", () => {
        video.play().catch((err) => console.log("Video play error:", err));
      });

      card.addEventListener("mouseleave", () => {
        video.pause();
        video.currentTime = 0;
      });
    });

    // Initialize product action buttons
    document.querySelectorAll(".product-action-btn").forEach((btn) => {
      btn.addEventListener("click", (e) => {
        e.preventDefault();
        e.stopPropagation();

        const action = btn.getAttribute("title");
        if (action === "Ver detalles") {
          // Handle view details action
          const card = btn.closest(".product-card");
          const productId = card
            ?.querySelector(".add-to-cart")
            ?.getAttribute("data-id");
          if (productId) {
            console.log(`Ver detalles del producto: ${productId}`);
            // Here you would navigate to product detail page or open modal
          }
        } else if (action === "Añadir a favoritos") {
          // Handle add to favorites action
          btn.classList.toggle("active");
          const isActive = btn.classList.contains("active");
          if (isActive) {
            btn
              .querySelector("i")
              ?.classList.replace("fa-heart", "fa-heart-broken");
            // Here you would add to favorites in your system
          } else {
            btn
              .querySelector("i")
              ?.classList.replace("fa-heart-broken", "fa-heart");
            // Here you would remove from favorites
          }
        }
      });
    });

    // Cart functionality has been removed

    // Animate elements on scroll
    const animateOnScroll = () => {
      const elements = document.querySelectorAll(
        ".service-card, .product-card, .testimonial-card",
      );

      elements.forEach((el) => {
        const rect = el.getBoundingClientRect();
        const isVisible =
          rect.top <=
            (window.innerHeight || document.documentElement.clientHeight) *
              0.8 && rect.bottom >= 0;

        if (isVisible) {
          el.classList.add("animate-fade-in");
        }
      });
    };

    // Initial check
    animateOnScroll();

    // Add scroll listener
    window.addEventListener("scroll", animateOnScroll);
  }
  
  // Función para inicializar la rotación de promociones
  function initPromoRotation() {
    const promoItems = document.querySelectorAll('.promo-item');
    const bgItems = document.querySelectorAll('.promo-bg-item');
    let currentPromo = 0;
    
    if (promoItems.length === 0) return; // No hay promociones para mostrar
    
    // Asegurarnos de que la primera promoción e imagen están activas
    promoItems[0].classList.add('active');
    
    // Si no hay suficientes promociones, no iniciamos la rotación
    if (promoItems.length <= 1) return;
    
    // Resetear cualquier estilo de animation-delay en las imágenes de fondo para sincronizarlas con JS
    bgItems.forEach(item => {
      item.style.animationDelay = '0s';
      // Hacemos que las imágenes no sean visibles inicialmente excepto la primera
      if (item !== bgItems[0]) {
        item.style.opacity = '0';
      }
    });
    
    // Cambiar promociones cada 4 segundos usando JS para mejor sincronización
    const ROTATION_INTERVAL = 4000; // 4 segundos
    
    setInterval(() => {
      // 1. Ocultar promoción actual (texto)
      promoItems[currentPromo].classList.remove('active');
      
      // 2. Ocultar imagen de fondo actual con fade
      if (bgItems[currentPromo]) {
        bgItems[currentPromo].style.opacity = '0';
        bgItems[currentPromo].style.transition = 'opacity 0.5s ease-out';
      }
      
      // 3. Avanzar al siguiente índice
      currentPromo = (currentPromo + 1) % promoItems.length;
      
      // 4. Mostrar la siguiente promoción (texto)
      promoItems[currentPromo].classList.add('active');
      
      // 5. Mostrar la siguiente imagen de fondo con fade
      if (bgItems[currentPromo]) {
        bgItems[currentPromo].style.opacity = '1';
        bgItems[currentPromo].style.transition = 'opacity 0.5s ease-in';
      }
      
      console.log(`Rotando a promoción #${currentPromo + 1}`);
    }, ROTATION_INTERVAL);
  }
</script>
